INFO: Number of nodes: 2
INFO: GPUs per node (this node): 1
INFO: Total GPUs for training (world size): 2
Attempting to find latest checkpoint iteration...
Found latest iteration: 0
START!
--- PBS_NODEFILE (/var/spool/pbs/aux/515446.opbs) content ---
mg0049
mg0050
--- Unique nodes in /tmp/515446.0765/tmp.qC3hWg16gj ---
mg0049
mg0050
--- nvidia-smi (on submission node) ---
Sat Jun 14 13:51:30 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GH200 120GB             On  |   00000009:01:00.0 Off |                    0 |
| N/A   22C    P0             76W /  700W |       6MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Master Addr: mg0049
Master Port: 29500
Number of Nodes for torchrun: 2
Processes per Node for torchrun: 1
Python script: /work/gg17/a97006/250519_modern_bert_0/Megatron-DeepSpeed/pretrain_bert.py
Logging to: /work/gg17/a97006/250519_modern_bert_0/Megatron-DeepSpeed/users/a97006/project/bert_with_pile/log//bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-13.51.30.log
--------------------------------------------------------------------------
mpirun --hostfile /tmp/515446.0765/tmp.qC3hWg16gj -np 2 -npernode 1 --map-by node -x CUDA_HOME -x LD_LIBRARY_PATH -x PATH \
torchrun     --nnodes 2     --nproc_per_node 1     --rdzv_id 515446.opbs     --rdzv_backend c10d     --rdzv_endpoint 172.17.1.49:29500     /work/gg17/a97006/250519_modern_bert_0/Megatron-DeepSpeed/pretrain_bert.py          --bert-no-binary-head     --override-opt_param-scheduler     --adam-beta1 0.9     --adam-beta2 0.999     --init-method-std 0.02     --tensor-model-parallel-size 1     --lr-decay-iters 20000     --lr-warmup-iters 100     --micro-batch-size 8     --global-batch-size 16     --num-layers 12     --hidden-size 768     --num-attention-heads 12     --seq-length 1024     --max-position-embeddings 1024     --train-iters 20000     --lr 1e-4     --min-lr 1e-5     --lr-decay-style linear     --split 949,50,1     --log-interval 1000     --eval-interval 100     --eval-iters 10     --save-interval 200     --weight-decay 1e-2     --clip-grad 1.0     --num-workers 4     --fp16     --load /work/gg17/a97006/250519_modern_bert_0/Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --save /work/gg17/a97006/250519_modern_bert_0/Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --tensorboard-queue-size 1     --log-timers-to-tensorboard     --log-batch-size-to-tensorboard     --log-validation-ppl-to-tensorboard     --tensorboard-dir /work/gg17/a97006/250519_modern_bert_0/Megatron-DeepSpeed/users/a97006/project/bert_with_pile/tensorboard/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-13.51.30     --wandb-project deepspeed-megatron     --wandb-exp-name test_2gpus     --wandb-save-dir /work/gg17/a97006/250519_modern_bert_0/users/a97006/project/bert_with_pile     --log-optimizer-states-to-tensorboard          --vocab-file /work/gg17/a97006/250519_modern_bert_0/tokenizer/vocab_30000.txt     --data-path 1.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pubmed/pubmed_30000/pubmed 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pmc/pubmed_30000/pmc 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/fda_label/pubmed_30000/fda_label 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/nih_books/pubmed_30000/nih_books     --num-workers 128     --data-impl mmap     --train-data-exact-num-epochs 10          --deepspeed     --deepspeed_config /work/gg17/a97006/250519_modern_bert_0/Megatron-DeepSpeed/examples_deepspeed/bert_with_pile/ds_config_bert_bsz16_mbsz8_log1000_zero0.json     --zero-stage 0     --pipeline-model-parallel-size 1     --no-pipeline-parallel
--------------------------------------------------------------------------
/work/opt/local/aarch64/cores/cuda/12.6
--------------------------------------------------------------------------
HOST: mg0049
HOST_IP: 172.17.1.49
--------------------------------------------------------------------------
mpirun LD_LIBRARY_PATH;PATH \
END OF SCRIPT
INFO: Number of nodes: 2
INFO: GPUs per node (this node): 1
INFO: Total GPUs for training (world size): 2
Attempting to find latest checkpoint iteration...
Found latest iteration: 0
START!
--- PBS_NODEFILE (/var/spool/pbs/aux/515448.opbs) content ---
mg0049
mg0050
--- Unique nodes in /tmp/515448.1874/tmp.dzwsRGtGdf ---
mg0049
mg0050
--- nvidia-smi (on submission node) ---
Sat Jun 14 13:53:51 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GH200 120GB             On  |   00000009:01:00.0 Off |                    0 |
| N/A   22C    P0             76W /  700W |       6MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Master Addr: mg0049
Master Port: 29500
Number of Nodes for torchrun: 2
Processes per Node for torchrun: 1
Python script: /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/pretrain_bert.py
Logging to: /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/log//bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-13.53.51.log
--------------------------------------------------------------------------
mpirun --hostfile /tmp/515448.1874/tmp.dzwsRGtGdf -np 2 -npernode 1 --map-by node -x CUDA_HOME -x LD_LIBRARY_PATH -x PATH \
torchrun     --nnodes 2     --nproc_per_node 1     --rdzv_id 515448.opbs     --rdzv_backend c10d     --rdzv_endpoint 172.17.1.49:29500     /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/pretrain_bert.py          --bert-no-binary-head     --override-opt_param-scheduler     --adam-beta1 0.9     --adam-beta2 0.999     --init-method-std 0.02     --tensor-model-parallel-size 1     --lr-decay-iters 20000     --lr-warmup-iters 100     --micro-batch-size 8     --global-batch-size 16     --num-layers 12     --hidden-size 768     --num-attention-heads 12     --seq-length 1024     --max-position-embeddings 1024     --train-iters 20000     --lr 1e-4     --min-lr 1e-5     --lr-decay-style linear     --split 949,50,1     --log-interval 1000     --eval-interval 100     --eval-iters 10     --save-interval 200     --weight-decay 1e-2     --clip-grad 1.0     --num-workers 4     --fp16     --load /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --save /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --tensorboard-queue-size 1     --log-timers-to-tensorboard     --log-batch-size-to-tensorboard     --log-validation-ppl-to-tensorboard     --tensorboard-dir /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/tensorboard/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-13.53.51     --wandb-project deepspeed-megatron     --wandb-exp-name test_2gpus     --wandb-save-dir /work/gg17/a97006/250519_modern_bert_0/users/a97006/project/bert_with_pile     --log-optimizer-states-to-tensorboard          --vocab-file /work/gg17/a97006/250519_modern_bert_0/tokenizer/vocab_30000.txt     --data-path 1.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pubmed/pubmed_30000/pubmed 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pmc/pubmed_30000/pmc 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/fda_label/pubmed_30000/fda_label 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/nih_books/pubmed_30000/nih_books     --num-workers 128     --data-impl mmap          --deepspeed     --deepspeed_config /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/examples_deepspeed/bert_with_pile/ds_config_bert_bsz16_mbsz8_log1000_zero0.json     --zero-stage 0     --pipeline-model-parallel-size 1     --no-pipeline-parallel
--------------------------------------------------------------------------
/work/opt/local/aarch64/cores/cuda/12.6
--------------------------------------------------------------------------
HOST: mg0049
HOST_IP: 172.17.1.49
--------------------------------------------------------------------------
mpirun LD_LIBRARY_PATH;PATH \
END OF SCRIPT
INFO: Number of nodes: 2
INFO: GPUs per node (this node): 1
INFO: Total GPUs for training (world size): 2
Attempting to find latest checkpoint iteration...
Found latest iteration: 0
START!
--- PBS_NODEFILE (/var/spool/pbs/aux/515455.opbs) content ---
mg0049
mg0050
--- Unique nodes in /tmp/515455.0207/tmp.oer2yt2sIO ---
mg0049
mg0050
--- nvidia-smi (on submission node) ---
Sat Jun 14 14:11:21 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GH200 120GB             On  |   00000009:01:00.0 Off |                    0 |
| N/A   23C    P0             76W /  700W |       7MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Master Addr: mg0049
Master Port: 29500
Number of Nodes for torchrun: 2
Processes per Node for torchrun: 1
Python script: /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/pretrain_bert.py
Logging to: /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/log//bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-14.11.21.log
--------------------------------------------------------------------------
mpirun --hostfile /tmp/515455.0207/tmp.oer2yt2sIO -np 2 -npernode 1 --map-by node -x CUDA_HOME -x LD_LIBRARY_PATH -x PATH \
torchrun     --nnodes 2     --nproc_per_node 1     --rdzv_id 515455.opbs     --rdzv_backend c10d     --rdzv_endpoint 172.17.1.49:29500     /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/pretrain_bert.py          --bert-no-binary-head     --override-opt_param-scheduler     --adam-beta1 0.9     --adam-beta2 0.999     --init-method-std 0.02     --tensor-model-parallel-size 1     --lr-decay-iters 20000     --lr-warmup-iters 100     --micro-batch-size 8     --global-batch-size 16     --num-layers 12     --hidden-size 768     --num-attention-heads 12     --seq-length 1024     --max-position-embeddings 1024     --train-iters 20000     --lr 1e-4     --min-lr 1e-5     --lr-decay-style linear     --split 949,50,1     --log-interval 1000     --eval-interval 100     --eval-iters 10     --save-interval 200     --weight-decay 1e-2     --clip-grad 1.0     --num-workers 4     --fp16     --load /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --save /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --tensorboard-queue-size 1     --log-timers-to-tensorboard     --log-batch-size-to-tensorboard     --log-validation-ppl-to-tensorboard     --tensorboard-dir /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/tensorboard/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-14.11.21     --wandb-project deepspeed-megatron     --wandb-exp-name test_2gpus     --wandb-save-dir /work/gg17/a97006/250519_modern_bert_0/users/a97006/project/bert_with_pile     --log-optimizer-states-to-tensorboard          --vocab-file /work/gg17/a97006/250519_modern_bert_0/tokenizer/vocab_30000.txt     --data-path 1.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pubmed/pubmed_30000/pubmed_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pmc/pubmed_30000/pmc_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/fda_label/pubmed_30000/fda_label_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/nih_books/pubmed_30000/nih_books_text_document     --num-workers 128     --data-impl mmap          --deepspeed     --deepspeed_config /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/examples_deepspeed/bert_with_pile/ds_config_bert_bsz16_mbsz8_log1000_zero0.json     --zero-stage 0     --pipeline-model-parallel-size 1     --no-pipeline-parallel
--------------------------------------------------------------------------
/work/opt/local/aarch64/cores/cuda/12.6
--------------------------------------------------------------------------
HOST: mg0049
HOST_IP: 172.17.1.49
--------------------------------------------------------------------------
mpirun LD_LIBRARY_PATH;PATH \
END OF SCRIPT
INFO: Number of nodes: 2
INFO: GPUs per node (this node): 1
INFO: Total GPUs for training (world size): 2
Attempting to find latest checkpoint iteration...
Found latest iteration: 0
START!
--- PBS_NODEFILE (/var/spool/pbs/aux/515466.opbs) content ---
mg0049
mg0050
--- Unique nodes in /tmp/515466.7329/tmp.dex9IsqkvQ ---
mg0049
mg0050
--- nvidia-smi (on submission node) ---
Sat Jun 14 14:48:28 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GH200 120GB             On  |   00000009:01:00.0 Off |                    0 |
| N/A   22C    P0             76W /  700W |       7MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Master Addr: mg0049
Master Port: 29500
Number of Nodes for torchrun: 2
Processes per Node for torchrun: 1
Python script: /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/pretrain_bert.py
Logging to: /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/log//bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-14.48.28.log
--------------------------------------------------------------------------
mpirun --hostfile /tmp/515466.7329/tmp.dex9IsqkvQ -np 2 -npernode 1 --map-by node -x CUDA_HOME -x LD_LIBRARY_PATH -x PATH \
torchrun     --nnodes 2     --nproc_per_node 1     --rdzv_id 515466.opbs     --rdzv_backend c10d     --rdzv_endpoint 172.17.1.49:29500     /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/pretrain_bert.py          --bert-no-binary-head     --override-opt_param-scheduler     --adam-beta1 0.9     --adam-beta2 0.999     --init-method-std 0.02     --tensor-model-parallel-size 1     --lr-decay-iters 20000     --lr-warmup-iters 100     --micro-batch-size 8     --global-batch-size 16     --num-layers 12     --hidden-size 768     --num-attention-heads 12     --seq-length 1024     --max-position-embeddings 1024     --train-iters 20000     --lr 1e-4     --min-lr 1e-5     --lr-decay-style linear     --split 949,50,1     --log-interval 1000     --eval-interval 100     --eval-iters 10     --save-interval 200     --weight-decay 1e-2     --clip-grad 1.0     --num-workers 4     --fp16     --load /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --save /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --tensorboard-queue-size 1     --log-timers-to-tensorboard     --log-batch-size-to-tensorboard     --log-validation-ppl-to-tensorboard     --tensorboard-dir /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/tensorboard/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-14.48.28     --wandb-project deepspeed-megatron     --wandb-exp-name test_2gpus     --wandb-save-dir /work/gg17/a97006/250519_modern_bert_0/users/a97006/project/bert_with_pile     --log-optimizer-states-to-tensorboard          --vocab-file /work/gg17/a97006/250519_modern_bert_0/tokenizer/vocab_30000.txt     --data-path 1.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pubmed/pubmed_30000/pubmed_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pmc/pubmed_30000/pmc_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/fda_label/pubmed_30000/fda_label_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/nih_books/pubmed_30000/nih_books_text_document     --num-workers 128     --data-impl mmap          --deepspeed     --deepspeed_config /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/examples_deepspeed/bert_with_pile/ds_config_bert_bsz16_mbsz8_log1000_zero0.json     --zero-stage 0     --pipeline-model-parallel-size 1     --no-pipeline-parallel
--------------------------------------------------------------------------
/work/opt/local/aarch64/cores/cuda/12.6
--------------------------------------------------------------------------
HOST: mg0049
HOST_IP: 172.17.1.49
--------------------------------------------------------------------------
mpirun LD_LIBRARY_PATH;PATH \
END OF SCRIPT
INFO: Number of nodes: 2
INFO: GPUs per node (this node): 1
INFO: Total GPUs for training (world size): 2
Attempting to find latest checkpoint iteration...
Found latest iteration: 20000
Updated latest checkpoint files to iteration 20000.
START!
--- PBS_NODEFILE (/var/spool/pbs/aux/516001.opbs) content ---
mg0049
mg0050
--- Unique nodes in /tmp/516001.5294/tmp.DWovPGxHqh ---
mg0049
mg0050
--- nvidia-smi (on submission node) ---
Sat Jun 14 20:16:02 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GH200 120GB             On  |   00000009:01:00.0 Off |                    0 |
| N/A   22C    P0             76W /  700W |       7MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Master Addr: mg0049
Master Port: 29500
Number of Nodes for torchrun: 2
Processes per Node for torchrun: 1
Python script: /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/pretrain_modern_bert.py
Logging to: /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/log//bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-20.16.02.log
--------------------------------------------------------------------------
mpirun --hostfile /tmp/516001.5294/tmp.DWovPGxHqh -np 2 -npernode 1 --map-by node -x CUDA_HOME -x LD_LIBRARY_PATH -x PATH \
torchrun     --nnodes 2     --nproc_per_node 1     --rdzv_id 516001.opbs     --rdzv_backend c10d     --rdzv_endpoint 172.17.1.49:29500     /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/pretrain_modern_bert.py          --bert-no-binary-head     --override-opt_param-scheduler     --adam-beta1 0.9     --adam-beta2 0.999     --init-method-std 0.02     --tensor-model-parallel-size 1     --lr-decay-iters 20000     --lr-warmup-iters 100     --micro-batch-size 8     --global-batch-size 16     --num-layers 12     --hidden-size 768     --num-attention-heads 12     --seq-length 1024     --max-position-embeddings 1024     --train-iters 20000     --lr 1e-4     --min-lr 1e-5     --lr-decay-style linear     --split 949,50,1     --log-interval 1000     --eval-interval 100     --eval-iters 10     --save-interval 200     --weight-decay 1e-2     --clip-grad 1.0     --num-workers 4     --fp16     --load /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --save /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/checkpoint/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp     --tensorboard-queue-size 1     --log-timers-to-tensorboard     --log-batch-size-to-tensorboard     --log-validation-ppl-to-tensorboard     --tensorboard-dir /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/users/a97006/project/bert_with_pile/tensorboard/bert-pubmed-test-0.11B-iters-2M-lr-1e-4-min-1e-5-wmup-100-dcy-2M-sty-linear-gbs-16-mbs-8-gpu-2-zero-0-mp-1-pp-1-nopp_mg0049_2025.06.14-20.16.02     --wandb-project deepspeed-megatron     --wandb-exp-name test_2gpus     --wandb-save-dir /work/gg17/a97006/250519_modern_bert_0/users/a97006/project/bert_with_pile     --log-optimizer-states-to-tensorboard          --vocab-file /work/gg17/a97006/250519_modern_bert_0/tokenizer/vocab_30000.txt     --data-path 1.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pubmed/pubmed_30000/pubmed_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/pmc/pubmed_30000/pmc_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/fda_label/pubmed_30000/fda_label_text_document 0.0 /work/gg17/a97006/250519_modern_bert_0/preprocessed/nih_books/pubmed_30000/nih_books_text_document     --num-workers 128     --data-impl mmap          --deepspeed     --deepspeed_config /work/gg17/a97006/250519_modern_bert_0/Inhouse-Megatron-DeepSpeed/examples_deepspeed/bert_with_pile/ds_config_bert_bsz16_mbsz8_log1000_zero0.json     --zero-stage 0     --pipeline-model-parallel-size 1     --no-pipeline-parallel
--------------------------------------------------------------------------
/work/opt/local/aarch64/cores/cuda/12.6
--------------------------------------------------------------------------
HOST: mg0049
HOST_IP: 172.17.1.49
--------------------------------------------------------------------------
mpirun LD_LIBRARY_PATH;PATH \
END OF SCRIPT
